(()=>{"use strict";const e=JSON.parse(sessionStorage.getItem("products"));function t(){const t=e.reduce(((e,t)=>e+t.price),0);document.getElementById("sum").innerHTML=`<strong>€ ${Number(t/100).toFixed(2)}</strong>`,console.log("Sum updated.")}function n(){document.getElementById("totalNumberOfItems").textContent=e.length,console.log("Total number of items updated.")}function o(){document.getElementById("btnConfirmOrder").classList.add("disabled"),console.log("Confirm button disabled")}function s(s){const l=s.target.parentElement.previousElementSibling,r=l.getElementsByClassName("name")[0].textContent,i=e.map((e=>e.name)).indexOf(r);e.splice(i,1),sessionStorage.setItem("products",JSON.stringify(e)),l.parentElement.parentElement.remove(),0==e.length&&o(),t(),n()}let l,r;if(null==e||""==e)l=' \n    <li class="list-group-item text-center">\n    <p class="mb-0 py-4 text-muted">Oups ! Vous n\'avez aucun article dans votre panier.</p>\n    <p id="sum" class="mb-0"></p>\n    </li>',document.getElementById("myCart").innerHTML=l,document.getElementById("totalNumberOfItems").textContent=0,console.log("Empty cart displayed."),o();else{function o(){let t='\n            <li class="list-group-item d-flex justify-content-between order-last">\n                <p class="mb-0">Total (EUR)</p>\n                <p id="sum" class="mb-0"></p>\n            </li>';for(let n=0;n<e.length;n++)t+=`\n            <li class="list-group-item border-top">\n                <div class="row py-2">\n                    <div class="col-4 col-md-3">\n                        <img class="img-fluid" src="${e[n].imageUrl}" alt="">\n                    </div>\n                    <div class="col-8 col-md-9">\n                        <h3 class="name h5 mb-0">${e[n].name}</h3>\n                        <small class="text-break text-muted">Lentille choisie: ${e[n].lense}</small>\n                        <p class="price mt-2">€ ${Number(e[n].price/100).toFixed(2)}</p>\n                    </div>\n                    <div class="d-inline text-end">\n                        <button type="button" class="btn btn-danger">supprimer</button>\n                    </div>\n                </div>\n            </li>`;return console.log("Cart list html ready."),t}l=o(),window.addEventListener("load",(()=>{document.getElementById("myCart").innerHTML=l,console.log("Cart list displayed.");const e=document.getElementsByClassName("btn-danger");for(let t=0;t<e.length;t++)e[t].addEventListener("click",(e=>s(e))),console.log("Listening to remove button...");t(),n()}))}document.getElementById("myForm").addEventListener("submit",(function(e){e.preventDefault(),i()}));const i=async()=>{const t=Array.from(document.querySelectorAll("#myForm input")).reduce(((e,t)=>({...e,[t.id]:t.value})),[]);console.log("Contact data get.");const n=e.reduce(((e,t)=>(e.push(t.id),e)),[]);console.log("Product IDs get.");const o={contact:t,products:n};console.log("Sending request...");const s=await fetch("http://localhost:3000/api/cameras/order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}),l=await s.json();r=l.orderId,console.log(`Request sent successful. Server response: Order ID ${r}`),sessionStorage.removeItem("products"),console.log('sessionStorage: "products" removed.'),sessionStorage.setItem("orderId",r),console.log('sessionStorage: "orderId" added.'),console.log("Redirecting to Thank You page."),location.href="thankyou.html"}})();