(()=>{"use strict";var e=JSON.parse(sessionStorage.getItem("products"));function t(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=n(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){l=!0,a=e},f:function(){try{c||null==r.return||r.return()}finally{if(l)throw a}}}}function n(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t,n,r,o,i,a){try{var c=e[i](a),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function c(e){o(a,r,i,c,l,"next",e)}function l(e){o(a,r,i,c,l,"throw",e)}c(void 0)}))}}var a,c=new URL(window.location.href).searchParams.get("id"),l=function(){var e=i(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:3000/api/cameras/".concat(c));case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=i(regeneratorRuntime.mark((function e(){var n,r,o,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l();case 3:a=e.sent,document.getElementById("title").textContent="Produit | ".concat(a.name," - Orinoco France"),document.getElementById("productImage").innerHTML='<img class="img-fluid" src="'.concat(a.imageUrl,'" alt="">'),document.getElementById("productName").textContent=a.name,document.getElementById("productPrice").textContent+="€ ".concat(Number(a.price/100).toFixed(2)),document.getElementById("description").textContent=a.description,n=a.lenses,r="<option>Choisissez votre lentille</option>",o=t(n);try{for(o.s();!(i=o.n()).done;)c=i.value,r+="<option>".concat(c,"</option>")}catch(e){o.e(e)}finally{o.f()}document.getElementById("lenses").innerHTML=r,e.next=20;break;case 16:e.prev=16,e.t0=e.catch(0),window.alert(e.t0),console.log(e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}(),s="",d=[];window.addEventListener("load",(function(){console.log("[ Page is fully loaded ]"),document.getElementById("lenses").addEventListener("change",(function(e){s=e.target.options[e.target.selectedIndex].text,console.log("[ Lense changed: ".concat(s," ]"))})),console.log("...Listening to lense change"),document.getElementById("btnAddToCart").addEventListener("click",(function(){if(""==s)window.alert("Veuillez sélectionner une autre lentille."),console.log("Button clicked, user needs to select a lense to proceed.");else{console.log("...Checking data in sessionStorage");var t=JSON.parse(sessionStorage.getItem("products"))||[];d=[].concat(function(e){if(Array.isArray(e))return r(e)}(o=t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||n(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[{id:a._id,name:a.name,price:a.price,imageUrl:a.imageUrl,lense:s}]),""==t||""==e.filter((function(e){return function(e){return e.id===a._id&&e.lense===s}(e)}))?(sessionStorage.setItem("products",JSON.stringify(d)),console.log("[ Product saved ! ]"),console.log("Button clicked!"),location.href="../pages/cart.html"):window.alert("Ce produit est déjà dans votre panier. Veuillez sélectionner une autre lentille ou rechercher un autre produit.")}var o})),console.log('...Listening to "Add to cart"')})),u()})();