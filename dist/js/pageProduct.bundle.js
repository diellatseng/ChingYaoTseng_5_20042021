(()=>{"use strict";var e,t=JSON.parse(sessionStorage.getItem("products"));function n(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){l=!0,i=e},f:function(){try{c||null==n.return||n.return()}finally{if(l)throw i}}}}function r(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t,n,r,o,a,i){try{var c=e[a](i),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){a(i,r,o,c,l,"next",e)}function l(e){a(i,r,o,c,l,"throw",e)}c(void 0)}))}}var c=new URL(window.location.href).searchParams.get("id"),l=function(){var e=i(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://localhost:3000/api/cameras/").concat(c));case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=function(){var t=i(regeneratorRuntime.mark((function t(){var r,o,a,i,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,l();case 3:e=t.sent,document.getElementById("title").textContent="Produit | ".concat(e.name," - Orinoco France"),document.getElementById("productImage").innerHTML='<img class="img-fluid" src="'.concat(e.imageUrl,'" alt="">'),document.getElementById("productName").textContent=e.name,document.getElementById("productPrice").textContent+="€ ".concat(Number(e.price/100).toFixed(2)),document.getElementById("description").textContent=e.description,r=e.lenses,o="<option>Choisissez votre lentille</option>",a=n(r);try{for(a.s();!(i=a.n()).done;)c=i.value,o+="<option>".concat(c,"</option>")}catch(e){a.e(e)}finally{a.f()}document.getElementById("lenses").innerHTML=o,t.next=20;break;case 16:t.prev=16,t.t0=t.catch(0),window.alert(t.t0),console.log(t.t0);case 20:case"end":return t.stop()}}),t,null,[[0,16]])})));return function(){return t.apply(this,arguments)}}(),s="",d=[];function f(){sessionStorage.setItem("products",JSON.stringify(d)),console.log("[ Product saved ! ]"),location.href="../pages/cart.html"}window.addEventListener("load",(function(){console.log("[ Page is fully loaded ]"),document.getElementById("lenses").addEventListener("change",(function(e){s=e.target.options[e.target.selectedIndex].text,console.log("[ Lense changed: ".concat(s," ]"))})),console.log("...Listening to lense change"),document.getElementById("btnAddToCart").addEventListener("click",(function(){if(""==s)window.alert("Veuillez sélectionner une autre lentille."),console.log("Button clicked, user needs to select a lense to proceed.");else{console.log("...Checking data in sessionStorage");var n=JSON.parse(sessionStorage.getItem("products"))||[];d=[].concat(function(e){if(Array.isArray(e))return o(e)}(a=n)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(a)||r(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[{id:e._id,name:e.name,price:e.price,imageUrl:e.imageUrl,lense:s}]),""==n||""==t.filter((function(t){return t.id===e._id&&t.lense===s}))?f():window.alert("Ce produit est déjà dans votre panier. Veuillez sélectionner une autre lentille ou rechercher un autre produit.")}var a})),console.log('...Listening to "Add to cart"')})),u()})();