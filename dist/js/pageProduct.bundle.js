(()=>{"use strict";var e=JSON.parse(sessionStorage.getItem("products"));function t(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=n(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){u=!0,i=e},f:function(){try{c||null==r.return||r.return()}finally{if(u)throw i}}}}function n(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function c(e){o(i,r,a,c,u,"next",e)}function u(e){o(i,r,a,c,u,"throw",e)}c(void 0)}))}}var i,c=new URL(window.location.href).searchParams.get("id"),u=function(){var e=a(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("http://localhost:3000/api/cameras/").concat(c));case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=a(regeneratorRuntime.mark((function e(){var n,r,o,a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u();case 3:i=e.sent,document.getElementById("title").textContent="Produit | ".concat(i.name," - Orinoco France"),document.getElementById("productImage").innerHTML='<img class="img-fluid" src="'.concat(i.imageUrl,'" alt="">'),document.getElementById("productName").textContent=i.name,document.getElementById("productPrice").textContent+="€ ".concat(Number(i.price/100).toFixed(2)),document.getElementById("description").textContent=i.description,n=i.lenses,r="<option>Choisissez votre lentille</option>",o=t(n);try{for(o.s();!(a=o.n()).done;)c=a.value,r+="<option>".concat(c,"</option>")}catch(e){o.e(e)}finally{o.f()}document.getElementById("lenses").innerHTML=r,e.next=20;break;case 16:e.prev=16,e.t0=e.catch(0),window.alert(e.t0),console.log(e.t0);case 20:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}(),l="",d=[];function f(){sessionStorage.setItem("products",JSON.stringify(d)),console.log("Product saved !"),location.href="../pages/cart.html"}window.addEventListener("load",(function(){document.getElementById("lenses").addEventListener("change",(function(e){l=e.target.options[e.target.selectedIndex].text,console.log("Lense changed: ".concat(l))})),document.getElementById("btnAddToCart").addEventListener("click",(function(){if(""==l)window.alert("Veuillez sélectionner une autre lentille.");else{console.log("...Checking data in sessionStorage");var t=JSON.parse(sessionStorage.getItem("products"))||[];d=[].concat(function(e){if(Array.isArray(e))return r(e)}(o=t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(o)||n(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[{id:i._id,name:i.name,price:i.price,imageUrl:i.imageUrl,lense:l}]),""==t||""==e.filter((function(e){return e.id===i._id&&e.lense===l}))?f():window.alert("Ce produit est déjà dans votre panier. Veuillez sélectionner une autre lentille ou rechercher un autre produit.")}var o}))})),s()})();